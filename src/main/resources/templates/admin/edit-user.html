<th:block th:insert="~{fragments/header :: header}">
    <title>Edit User</title>
</th:block>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card shadow">
            <div class="card-header bg-warning text-dark">
                <h4 class="mb-0">Edit User</h4>
            </div>
            <div class="card-body">
                <form th:action="@{'/admin/edit/' + ${user.id}}" th:object="${user}" method="post">
                    <input type="hidden" th:field="*{id}">

                    <div th:if="${#fields.hasErrors('*')}" class="alert alert-danger">
                        <div th:each="err : ${#fields.errors('*')}" th:text="${err}"></div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Username</label>
                            <input type="text" class="form-control" th:field="*{username}" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" th:field="*{email}" required>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">New Password (leave empty to keep current)</label>
                        <input type="password" class="form-control" th:field="*{password}">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Roles</label>
                        <select class="form-select" th:field="*{roles}" multiple>
                            <option th:each="role : ${allRoles}"
                                    th:value="${role.id}"
                                    th:selected="${#lists.contains(user.roles, role)}"
                                    th:text="${role.role.replace('ROLE_', '')}">
                            </option>
                        </select>
                    </div>

                    <div class="d-flex justify-content-end">
                        <a th:href="@{/admin}" class="btn btn-secondary me-2">Cancel</a>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<th:block th:insert="~{fragments/footer :: footer}"></th:block>